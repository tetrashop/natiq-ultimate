<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ù†Ù‡Ø§ÛŒÛŒ Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­</title>
    <style>
        body { font-family: Tahoma; padding: 20px; }
        input { padding: 10px; width: 300px; }
        button { padding: 10px 20px; }
        .result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>ğŸ¯ ØªØ³Øª Ù†Ù‡Ø§ÛŒÛŒ API Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­</h1>
    
    <div>
        <input type="text" id="query" placeholder="Ø¹Ø¨Ø§Ø±Øª Ø¬Ø³ØªØ¬Ùˆ..." value="Ù¾Ø±Ø¯Ø§Ø²Ø´">
        <button onclick="search()">ğŸ” Ø¬Ø³ØªØ¬Ùˆ</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        async function search() {
            const query = document.getElementById('query').value;
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ...</p>';
            
            try {
                // Ø±ÙˆØ´ ØµØ­ÛŒØ­: encodeURIComponent
                const response = await fetch(`http://localhost:3000/api/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                let html = `<h3>Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ "${query}":</h3>`;
                
                if (data.success) {
                    html += `<p>âœ… ${data.totalResults} Ù…Ù‚Ø§Ù„Ù‡ ÛŒØ§ÙØª Ø´Ø¯</p>`;
                    
                    if (data.results.length > 0) {
                        data.results.forEach(item => {
                            html += `
                                <div class="result">
                                    <strong>${item.article.title}</strong><br>
                                    <small>${item.article.excerpt}</small><br>
                                    <em>Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: ${item.article.author}</em>
                                </div>
                            `;
                        });
                    }
                } else {
                    html += `<p style="color: red;">âŒ ${data.error}</p>`;
                }
                
                resultsDiv.innerHTML = html;
            } catch (error) {
                resultsDiv.innerHTML = `<p style="color: red;">âŒ Ø®Ø·Ø§: ${error.message}</p>`;
            }
        }
        
        // ØªØ³Øª Ø®ÙˆØ¯Ú©Ø§Ø±
        setTimeout(search, 1000);
    </script>
</body>
</html>
