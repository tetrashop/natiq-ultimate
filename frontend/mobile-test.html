<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ“± ØªØ³Øª Ù…ÙˆØ¨Ø§ÛŒÙ„ - Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­</title>
    <style>
        :root {
            --primary: #3498db;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 100%;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .search-box {
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
        }
        
        .quick-actions {
            display: flex;
            overflow-x: auto;
            padding: 15px;
            gap: 10px;
            background: white;
        }
        
        .action-btn {
            flex-shrink: 0;
            padding: 10px 15px;
            background: var(--primary);
            color: white;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .test-section {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .test-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-right: 4px solid #dee2e6;
        }
        
        .test-item.success {
            border-right-color: var(--success);
        }
        
        .test-item.error {
            border-right-color: var(--danger);
        }
        
        .test-item .status {
            font-size: 12px;
            padding: 3px 10px;
            border-radius: 15px;
            margin-right: 10px;
        }
        
        .status.success {
            background: #d4edda;
            color: var(--success);
        }
        
        .status.error {
            background: #f8d7da;
            color: var(--danger);
        }
        
        .status.pending {
            background: #fff3cd;
            color: var(--warning);
        }
        
        .result-box {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px;
            overflow-x: auto;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .floating-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px;
            border-radius: 25px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: none;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“± ØªØ³Øª Ù…ÙˆØ¨Ø§ÛŒÙ„</h1>
            <p>Ù†Ø·Ù‚ Ù…ØµØ·Ù„Ø­ - Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„</p>
        </div>
        
        <div class="search-box">
            <input type="text" id="mobileSearch" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ù‚Ø§Ù„Ø§Øª...">
        </div>
        
        <div class="quick-actions">
            <a href="javascript:void(0)" class="action-btn" onclick="testSearch('NLP')">ğŸ”¤ NLP</a>
            <a href="javascript:void(0)" class="action-btn" onclick="testSearch('Ù…Ù‚Ø§Ù„Ù‡ 203')">ğŸ¯ Ù…Ù‚Ø§Ù„Ù‡ 203</a>
            <a href="javascript:void(0)" class="action-btn" onclick="runTest('health')">âœ… Ø³Ù„Ø§Ù…Øª</a>
            <a href="javascript:void(0)" class="action-btn" onclick="runTest('stats')">ğŸ“Š Ø¢Ù…Ø§Ø±</a>
            <a href="javascript:void(0)" class="action-btn" onclick="runTest('articles')">ğŸ“„ Ù…Ù‚Ø§Ù„Ø§Øª</a>
        </div>
        
        <div class="test-section">
            <h3 style="margin-bottom: 15px;">ğŸ§ª ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ API</h3>
            <div id="testsList">
                <!-- ØªØ³Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </div>
        
        <div class="test-section">
            <h3 style="margin-bottom: 15px;">ğŸ” Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬Ùˆ</h3>
            <div id="searchResults">
                Ù…Ù†ØªØ¸Ø± Ø¬Ø³ØªØ¬Ùˆ...
            </div>
        </div>
    </div>
    
    <button class="floating-btn" onclick="runAllTests()">
        â–¶ï¸ Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§
    </button>

    <script>
        const API_BASE = 'http://localhost:3000/api';
        const tests = [
            { id: 'health', name: 'Ø³Ù„Ø§Ù…Øª Ø³ÛŒØ³ØªÙ…', endpoint: '/health' },
            { id: 'stats', name: 'Ø¢Ù…Ø§Ø± Ø³ÛŒØ³ØªÙ…', endpoint: '/stats' },
            { id: 'articles', name: 'Ù„ÛŒØ³Øª Ù…Ù‚Ø§Ù„Ø§Øª', endpoint: '/articles?page=1&limit=3' },
            { id: 'article-203', name: 'Ù…Ù‚Ø§Ù„Ù‡ 203', endpoint: '/article/203' }
        ];
        
        function createTestItem(test) {
            return `
                <div class="test-item" id="test-${test.id}">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <strong>${test.name}</strong>
                        <span class="status pending">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</span>
                    </div>
                    <button onclick="runTest('${test.id}')" style="
                        background: var(--primary);
                        color: white;
                        border: none;
                        padding: 8px 15px;
                        border-radius: 5px;
                        width: 100%;
                    ">Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª</button>
                    <div class="result-box" id="result-${test.id}"></div>
                </div>
            `;
        }
        
        async function runTest(testId) {
            const test = tests.find(t => t.id === testId);
            if (!test) return;
            
            const testEl = document.getElementById(`test-${testId}`);
            const resultEl = document.getElementById(`result-${testId}`);
            const statusEl = testEl.querySelector('.status');
            
            statusEl.className = 'status pending';
            statusEl.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§...';
            
            try {
                const response = await fetch(API_BASE + test.endpoint);
                const data = await response.json();
                
                resultEl.innerHTML = `<pre>${JSON.stringify(data, null, 2).substring(0, 200)}...</pre>`;
                
                if (data.success || (testId === 'health' && data.status)) {
                    statusEl.className = 'status success';
                    statusEl.textContent = 'âœ… Ù…ÙˆÙÙ‚';
                    testEl.className = 'test-item success';
                } else {
                    statusEl.className = 'status error';
                    statusEl.textContent = 'âŒ Ø®Ø·Ø§';
                    testEl.className = 'test-item error';
                }
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = 'âŒ Ø®Ø·Ø§';
                testEl.className = 'test-item error';
                resultEl.innerHTML = `Ø®Ø·Ø§: ${error.message}`;
            }
        }
        
        async function testSearch(query) {
            const resultsEl = document.getElementById('searchResults');
            resultsEl.innerHTML = '<div class="test-item"><em>Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ...</em></div>';
            
            try {
                const response = await fetch(`${API_BASE}/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (data.success && data.results.length > 0) {
                    let html = '';
                    data.results.forEach(result => {
                        html += `
                            <div class="test-item success">
                                <strong>${result.article.title}</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 5px;">
                                    ${result.article.author} â€¢ ${result.article.category}
                                </div>
                            </div>
                        `;
                    });
                    resultsEl.innerHTML = html;
                } else {
                    resultsEl.innerHTML = '<div class="test-item error">âŒ Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</div>';
                }
            } catch (error) {
                resultsEl.innerHTML = `<div class="test-item error">âŒ Ø®Ø·Ø§: ${error.message}</div>`;
            }
        }
        
        async function runAllTests() {
            for (const test of tests) {
                await runTest(test.id);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('testsList').innerHTML = tests.map(createTestItem).join('');
            
            // Ø§Ø¬Ø±Ø§ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± ØªØ³Øª Ø³Ù„Ø§Ù…Øª
            setTimeout(() => runTest('health'), 1000);
            
            // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¬Ø³ØªØ¬Ùˆ
            document.getElementById('mobileSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && this.value.trim().length >= 2) {
                    testSearch(this.value.trim());
                }
            });
        });
    </script>
</body>
</html>
